# hc-web â€” Next.js on Fly.io (standalone build)
app = "hc-web"
primary_region = "iad"

[build]
  dockerfile = "apps/web/Dockerfile"

[env]
  NODE_ENV = "production"
  NEXT_TELEMETRY_DISABLED = "1"

  # Search (internal Fly network)
  TYPESENSE_HOST = "hc-typesense.internal"
  TYPESENSE_PORT = "8108"
  TYPESENSE_PROTOCOL = "http"
  # TYPESENSE_API_KEY set via `fly secrets` (search-only key)

  # Email (internal Fly network)
  LISTMONK_URL = "http://hc-listmonk.internal:9000"

  # Supabase + SES creds set via `fly secrets`

[http_service]
  internal_port = 3000
  force_https = true
  auto_stop_machines = "stop"
  auto_start_machines = true
  min_machines_running = 1

[[vm]]
  cpu_kind = "shared"
  cpus = 2
  memory_mb = 2048
